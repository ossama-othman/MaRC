MAP:     test_map.fits             # Output file name
COMMENT: Test comment.
XCOMMENT: Test FITS extension comment.

                BODY:   Jupiter
                EQ_RAD:         71492
                POL_RAD:        66854
                ROTATION:       PROGRADE

        DATA_TYPE:              LONG
        GRID:                   YES
        GRID_INTERVAL:          2
        TYPE:                   SIMPLE_C

        OPTIONS:
                CENTRIC
                LO_LAT:         25 S
                HI_LAT:         4 S
                LO_LON:         45  W
                HI_LON:         100 W

        PLANES:         9
        SAMPLES:        50
        LINES:          25

        PLANE:  1       #410nm

# The `test.fits.gz' file used below currently contains only a test
# pattern unrelated to any planet/body.

                IMAGE:  test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2807.61
                        LINE_CENTER:            1200.67
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         0.06 S
                        SUB_OBSERV_LON:         215.63 E
                        POSITION_ANGLE:         179.175
                        SUB_SOLAR_LAT:          0.22
                        SUB_SOLAR_LON:          284.67 E
                        RANGE:                  1211230
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

                IMAGE: test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        INVERT:                 BOTH
                        REMOVE_SKY:             YES
                        SAMPLE_CENTER:          2456.39
                        LINE_CENTER:            1195.58
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         215.48 E
                        POSITION_ANGLE:         179.163
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          284.52 E
                        RANGE:                  1211114
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

        PLANE:  2       #756nm
                IMAGE: test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        INTERPOLATE:            YES
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2833.21
                        LINE_CENTER:            1201.89
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         215.05 E
                        POSITION_ANGLE:         179.175
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          284.05 E
                        RANGE:                  1210750
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

                IMAGE: test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2561.00
                        LINE_CENTER:            845.733
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         214.61 E
                        POSITION_ANGLE:         179.246
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          283.60 E
                        RANGE:                  1210392
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084


        PLANE:  3       #727nm

                IMAGE: test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2587.43
                        LINE_CENTER:            842.981
                        GEOM_CORRECT:           YES
                        EMI_ANG_LIMIT:          75
                        TERMINATOR:             YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         214.03 E
                        POSITION_ANGLE:         179.246
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          282.99 E
                        RANGE:                  1209912
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

        PLANE:  4       #889nm
                IMAGE: test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2967.82
                        LINE_CENTER:            848.808
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         213.60 E
                        POSITION_ANGLE:         179.247
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          282.53 E
                        RANGE:                  1209552
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

                IMAGE: test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2617.95
                        LINE_CENTER:            843.217
                        FLAT_FIELD:             test.fits.gz
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         213.45 E
                        POSITION_ANGLE:         179.246
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          282.37 E
                        RANGE:                  1209431
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

        PLANE:  5
                DATA_MIN: 0
                MU:     SUB_OBSERV_LAT:         -0.06 C
                        SUB_OBSERV_LON:         214.54 E
                        RANGE:                  1210332.1 KM

        PLANE:  6
                MU0:    SUB_SOLAR_LAT:          -0.22 C
                        SUB_SOLAR_LON:          283.52 E

        PLANE:  7
                PHASE:  SUB_OBSERV_LAT:         -0.06 C
                        SUB_OBSERV_LON:         214.54 E
                        RANGE:                  1210332.1 KM
                        SUB_SOLAR_LAT:          -0.22 C
                        SUB_SOLAR_LON:          283.52 E

        PLANE:  8
                LATITUDE: LATITUDE_TYPE: CENTRIC

        PLANE: 9
                LONGITUDE

MAP:    test_map2.fits
        BODY:   Jupiter
                POL_RAD:        66854
                FLATTENING:     (71492 - 66854) / 71492
                ROTATION:       PROGRADE

        DATA_TYPE:              BYTE
        GRID:                   YES
        TYPE:                   ORTHO
                OPTIONS:
                        AVERAGING:      NONE
                        SUB_OBSERV_LAT: -5
                        SUB_OBSERV_LON: 215 E
                        POSITION_ANGLE: 20
                        KM_PER_PIXEL:   25
                        LAT_AT_CENTER:  46
                        LON_AT_CENTER:  110 W
        PLANES:         1
        SAMPLES:        25
        LINES:          25

        PLANE:
                IMAGE:  test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        INTERPOLATE:            NO
                        REMOVE_SKY:             NO
                        LINE_CENTER:            1200.67
                        SAMPLE_CENTER:          2807.61
                        GEOM_CORRECT:           NO
                        TERMINATOR:             NO
                        SUB_OBSERV_LAT:         0.06 S
                        SUB_OBSERV_LON:         215.63 E
                        POSITION_ANGLE:         179.175
                        SUB_SOLAR_LAT:          0.22 N
                        SUB_SOLAR_LON:          284.67 E
                        RANGE:                  0.00809057036933 AU
                        ARCSEC_PER_PIX:         0.125

                IMAGE: test.fits.gz
                        NIBBLE:                 5
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2967.82
                        LINE_CENTER:            848.808
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         213.60 E
                        POSITION_ANGLE:         179.247
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          282.53 E
                        RANGE:                  1209552
                        KM_PER_PIXEL:           31.5

MAP:    test_map3.fits
        BODY:   Jupiter
                EQ_RAD:         71492
                FLATTENING:     (71492 - 66854) / 71492
                ROTATION:       PROGRADE
        DATA_OFFSET:            -1
        DATA_SCALE:             2
        DATA_TYPE:              FLOAT
        GRID:
                   YES
        TYPE:   P_STEREO
                OPTIONS:
                        AVERAGING:  UNWEIGHTED
                        POLE:       NORTH
                        MAX_LAT:    30 S

        SAMPLES:        25
        LINES:          25

        PLANE:
                IMAGE:  test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2807.61
                        LINE_CENTER:            1200.67
                        GEOM_CORRECT:           NO
                        SUB_OBSERV_LAT:         0.06 S
                        SUB_OBSERV_LON:         215.63 E
                        POSITION_ANGLE:         179.175 CCW
                        SUB_SOLAR_LAT:          0.22
                        SUB_SOLAR_LON:          284.67 E
                        RANGE:                  1211230
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

                IMAGE: test.fits.gz
                        NIBBLE:                 5
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2967.82
                        LINE_CENTER:            848.808
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         213.60 E
                        POSITION_ANGLE:         180.825 CW
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          282.53 E
                        RANGE:                  1209552
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

MAP:    test_map4.fits
        AUTHOR: Foo Bar
        ORIGIN: Baz
        BODY:   Jupiter
                EQ_RAD:         71492
                POL_RAD:        66854
                ROTATION:       PROGRADE
        DATA_TYPE:              SHORT
        DATA_BLANK:             -32768
        GRID:                   NO
        TYPE:                   SIMPLE_C
        OPTIONS:
                HI_LAT:         90 N
                LO_LAT:         90 S
                HI_LON:         360 W
                LO_LON:         0  W
        SAMPLES:        25
        LINES:          25

        PLANE:
                DATA_MIN: 0
                MU:     SUB_OBSERV_LAT:         -25 C
                        SUB_OBSERV_LON:         214.54 E
                        RANGE:                  1210332.1 KM
                        # NOTE: Sub-solar point is no longer necessary
                        #       for MU plane.
                        SUB_SOLAR_LAT:          -0.22 C
                        SUB_SOLAR_LON:          283.52 E

MAP:    test_map5.fits
        BODY:   Jupiter
                EQ_RAD:         71492
                POL_RAD:        66854
                ROTATION:       PROGRADE
        DATA_TYPE:              LONGLONG
        DATA_BLANK:             -9223372036854775808  # INT64_MIN
        GRID:                   NO
        TYPE:                   SIMPLE_C
        SAMPLES:        25
        LINES:          25

        PLANE:
                MU0:
                        # NOTE: Sub-observer point and range are no
                        #       longer necessary for MU0 plane.
                        SUB_OBSERV_LON:         214.54 E
                        SUB_OBSERV_LAT:         -0.06 C
                        RANGE:                  1210332.1 KM
                        SUB_SOLAR_LON:          -283.52
                        SUB_SOLAR_LAT:          -0.22 C

MAP:    test_map6.fits
        BODY:   Jupiter
                FLATTENING:     (71492 - 66854) / 71492
                POL_RAD:        66854
                ROTATION:       PROGRADE
        DATA_OFFSET:            -1
        DATA_SCALE:             2
        DATA_TYPE:              DOUBLE
        GRID:                   NO
        TYPE:                   SIMPLE_C
        OPTIONS:
                LATITUDE_TYPE: GRAPHIC
        SAMPLES:        25
        LINES:          25
        PLANE:
                DATA_MAX: 0
                PHASE:  SUB_OBSERV_LAT:         -acos(cos(0.06))
                        SUB_OBSERV_LON:         214.54 E
                        RANGE:                  1210332.1 KM
                        SUB_SOLAR_LAT:          -0.22 C
                        SUB_SOLAR_LON:          283.52 E

MAP:    test_map7.fits
        BODY:   Venus
                POL_RAD:        sqrt(6051.8 ^ 2)
                EQ_RAD:         6051.8
                ROTATION:       RETROGRADE
        DATA_TYPE:              SHORT
        GRID:                   YES
        LAT_GRID_INTERVAL:      2
        LON_GRID_INTERVAL:      2
        TYPE:                   MERCATOR
        SAMPLES:        25
        LINES:          25
        PLANE:
                LATITUDE : GRAPHIC

MAP:    test_map8.fits
        BODY:   Venus
                FLATTENING:     (6051.8 + -6051.8) * 1 / 6051.8
                EQ_RAD:         6051.8
                ROTATION:       RETROGRADE
        DATA_OFFSET:            -1
        DATA_SCALE:             2
        DATA_TYPE:              FLOAT
        GRID:   YES
        TYPE:   P_STEREO
                OPTIONS:
                        AVERAGING:  UNWEIGHTED
                        POLE:       SOUTH
                        MAX_LAT:    30 S

        SAMPLES:        25
        LINES:          25

        PLANE:
                DATA_MAX: 1000
                DATA_MIN: -1000
                IMAGE:  test.fits.gz
                        NIBBLE_LEFT:            4
                        NIBBLE_RIGHT:           8
                        NIBBLE_BOTTOM:          4
                        NIBBLE_TOP:             4
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2807.61
                        LINE_CENTER:            1200.67
                        GEOM_CORRECT:           NO
                        SUB_OBSERV_LAT:         0.06 S G
                        SUB_OBSERV_LON:         215.63 E
                        POSITION_ANGLE:         179.175 CCW
                        SUB_SOLAR_LAT:          0.22
                        SUB_SOLAR_LON:          284.67 W
                        RANGE:                  1211230
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084

                IMAGE: test.fits.gz
                        NIBBLE:                 5
                        REMOVE_SKY:             NO
                        SAMPLE_CENTER:          2967.82
                        LINE_CENTER:            848.808
                        GEOM_CORRECT:           YES
                        SUB_OBSERV_LAT:         -0.06
                        SUB_OBSERV_LON:         213.60 E
                        POSITION_ANGLE:         180.825 CW
                        SUB_SOLAR_LAT:          -0.22
                        SUB_SOLAR_LON:          282.53 E
                        RANGE:                  1209552
                        FOCAL_LENGTH:           1501.039
                        PIXEL_SCALE:            32.8084
